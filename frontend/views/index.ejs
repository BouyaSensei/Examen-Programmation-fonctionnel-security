<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Store</title>
    <!-- Liens CDN pour Bootstrap -->
    <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
            rel="stylesheet"
    />
    <!-- Liens CDN pour Materialize -->
    <link
            href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css"
            rel="stylesheet"
    />
    <style>
        /* Ajouter des styles personnalisés ici pour résoudre les conflits */

        .plus-sign {
            font-size: 2rem; /* Change the size as needed */
            color: #007bff; /* Bootstrap primary color */
        }
    </style>
</head>
<body>
<%- include('./components/navbar') %>
<!-- Inclusion de la Navbar -->

<!-- ajout d'un + au cas ou utilisateur connecter pour ajouter produit -->
<% if (locals.token) { %>
    <div class="d-flex justify-content-center align-items-center" style="height: 10vh;">
        <a class="plus-sign" href="/addProduct">+</a>
    </div>
<% } %>
<!-- Barre de recherche -->

<div class="container mt-4">
    <div class="row">
        <div class="col-md-8 offset-md-2">
            <form>
                <div class="input-field">
                    <input
                            type="text"
                            id="search"
                            class="form-control"
                            placeholder="Recherche de produits..."
                    />
                    <label for="search">Rechercher</label>
                </div>
            </form>
            <!-- Affichage des produits -->
            <div class="container mt-4" id="products">
                <div class="row">
                    <% products.map(function(product) { %>
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-body">
                                    <h5 class="card-title"><%= product.Libellé %></h5>
                                    <p class="card-text"><%= product.Description %></p>
                                    <p class="card-text"><%= product.Prix %> €</p>
                                    <a href="#" class="btn btn-primary">Voir plus</a>
                                </div>
                            </div>
                        </div>
                    <% }) %>
                </div>
            </div>
            <!-- Fin de l'affichage des produits -->
        </div>
    </div>
</div>

<!-- Scripts nécessaires pour Bootstrap et Materialize -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // Récupération des produits
    const products = Array.from(document.querySelectorAll('#products .col-md-4'));

    // Ajout d'un écouteur d'événement sur l'input de recherche
    document.getElementById('search').addEventListener('input', (e) => {
        // Récupération de la valeur de recherche
        const searchValue = e.target.value.toLowerCase();

        // Filtrage des produits
        products.forEach((product) => {
            const productName = product.querySelector('.card-title').textContent.toLowerCase();
            product.style.display = productName.includes(searchValue) ? '' : 'none';
        });
    });
</script>
</body>
</html>
